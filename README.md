Данный репозиторий содержит два файла:
1. `model4.py` - файл скачивания и обучения модели
2. `use3.py` - файл эксплуатации модели

# model4.py
## Функции программы
Данная программа производит следующие функции:
- анализ вводимого датасета на поиск значений 29 999 с удалением строк с такими значениями на случай, если при обработке датасета были пропущены такие значения (функция «`prepare_data()`»);
- разделение полученного датасета на обучающую и валидационную выборки в соотношении 70/30 (производится в функции «`prepare_data()`», в которой также вызываются описанные выше функции);
- приведение датасета к текстовому виду (функция «`create_ecg_text()`»);
- балансировку классов перед обучением (функция «`prepare_data()`»);
- загрузку модели и токенизатора;
- токенизацию датасета (функция «`tokenize_function()`»);
- установку параметров обучения (функция «`compute_metrics()`» запись в переменную `training_args` и последующее объединение параметров в переменной `trainer`)
- непосредственное обучение модели

Примечание: параметры обучения были отобраны в соответствии с целью избегания переобучения (`weight_decay`)  на малом датасете, укладывания программы в ограниченные ресурсы, а также приоритет обучения для класса 0 (потенциальные аномалии) с учётом точности и полноты обучения (метрика `f1`).
- непосредственное дообучение и сохранение модели;

# use3.py
## Функции программы
Данная программа производит:
- загрузку дообученной модели и токенизатора (класс «`ECGClassifier`»);
- преобразование входных данных (функция «`create_ecg_text(`)»);
Входные данные предоставляются в виде набора показаний в формате .csv (функция «`predict_from_csv(`)»);

## Порядок подготовки и запуска программы
1. Подготовить .csv-файл с данными для обработке в формате, аналогичном датасету «`csv_data.csv`».
2. Запуск выполнения файла «`use3.py`» с следующими ключами:
-     «`имя_файла.csv`» для обработки, в противном случае программа самостоятельно создаст такой файл с тестовыми данными;
-     «`-o`» или «`--output`» с указанием места и имя сохраняемого файла с результатами, в противном случае в каталоге с python-файлом будет создан файл с постфиксом имени входного файла «_predicted»;
-     «`-m`» или «`--model`» с указанием расположения и имени каталога модели, в противном случае будет использовано стандартное значение «`./ecg_classifier_final`».

Вывод программы в консоль состоит из статистики обработанных данных, а также первых нескольких значений.

### Требования к входному файлу

Входной файл должен содержать следующие поля (колонки) в оригинальной последовательности:
- `rr_interval`;
- `p_onset`;
- `p_end`;
- `qrs_onset`;
- `qrs_end`;
- `t_end`;
- `p_axis`;
- `qrs_axis`;
- `t_axis`.

### Поля выходного файла

Выходной файл содержит следующие поля (колонки):
- `sample_id` – Номер записи;
- `prediction` – Предсказанный класс (0/1);
- `label` – Текстовая метка;
- `confidence` – Уверенность;
- `probability_healthy` – вероятность отношения к классу «Healthy»;
- `probability_abnormal` – вероятность отношения к классу «Potentially anomalous».

# Результаты
После обучения модели на предоставленном датасете и при последующем применении модели на наборе данных из того же файла-датасета было достигнуто соответствие в 64.67% между предсказанными классами и предоставленным набором "показание-класс" датасета.
